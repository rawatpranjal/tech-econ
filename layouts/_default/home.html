{{ define "main" }}
<div class="homepage">
    <!-- Hero Section -->
    <header class="hero">
        <h1 class="hero-title">tech-econ</h1>
        <p class="hero-tagline">The largest curated library for tech economists.</p>
        {{ $paperCount := 0 }}{{ range .Site.Data.papers.topics }}{{ range .subtopics }}{{ $paperCount = add $paperCount (len .papers) }}{{ end }}{{ end }}
        {{ $total := add (len .Site.Data.packages) (add (len .Site.Data.datasets) (add (len .Site.Data.resources) (add (len .Site.Data.talks) (add (len .Site.Data.books) (add (len .Site.Data.career) (add (len .Site.Data.community) $paperCount)))))) }}
        <p class="hero-subtitle">{{ len .Site.Data.packages }} packages • {{ len .Site.Data.datasets }} datasets • {{ $paperCount }} papers • {{ len .Site.Data.resources }} learning resources</p>
        <p class="hero-inspiration">See what others have done to imagine what's possible.</p>
    </header>

    <!-- Homepage Search Bar -->
    <div class="homepage-search" data-aos="fade-up">
        <div class="search-input-wrapper" onclick="document.getElementById('global-search-modal').style.display='flex'; document.getElementById('global-search-input').focus();">
            <svg class="search-icon" viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
            </svg>
            <input type="text" class="search-input" placeholder="Search packages, datasets, resources..." readonly>
            <kbd class="search-kbd">⌘K</kbd>
        </div>
    </div>

    <!-- Trending Now Carousel -->
    {{ with .Site.Data.homepage_trending }}
    {{ if .items }}
    <section class="home-trending" data-aos="fade-up">
        <div class="explore-row">
            <h2 class="explore-row-title">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px; vertical-align: middle;">
                    <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                    <polyline points="17 6 23 6 23 12"></polyline>
                </svg>
                Trending Now
            </h2>
            <div class="explore-scroller">
                {{ range .items }}
                <a href="{{ .url }}" target="_blank" rel="noopener" class="explore-card explore-card-trending">
                    <div class="explore-card-header">
                        <div class="explore-card-icon">
                            {{ if findRE "github\\.com" .url }}
                            {{ $owner := replaceRE "https://github.com/([^/]+).*" "$1" .url }}
                            <img src="https://github.com/{{ $owner }}.png?size=48" alt="" loading="lazy" onerror="this.parentElement.classList.add('icon-fallback')">
                            {{ else }}
                            <img src="https://www.google.com/s2/favicons?domain={{ .url | replaceRE `^https?://([^/]+).*` `$1` }}&sz=32" alt="" loading="lazy" onerror="this.parentElement.classList.add('icon-fallback')">
                            {{ end }}
                            <svg class="fallback-icon" viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                                {{ if eq .type "paper" }}<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline>
                                {{ else if eq .type "package" }}<path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line>
                                {{ else if eq .type "dataset" }}<ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path>
                                {{ else }}<circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>{{ end }}
                            </svg>
                        </div>
                        <span class="explore-card-type">{{ .type }}</span>
                    </div>
                    <h3>{{ .name }}</h3>
                    {{ if .description }}<p class="explore-card-desc">{{ .description }}</p>{{ end }}
                </a>
                {{ end }}
            </div>
        </div>
    </section>
    {{ end }}
    {{ end }}

    <!-- Getting Started CTA -->
    <div class="cta-banner" data-aos="fade-up">
        <div class="cta-content">
            <a href="{{ "start/" | relURL }}" class="cta-icon">
                <svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                </svg>
            </a>
            <div class="cta-text">
                <h2>New here?</h2>
                <p>Check out our curated roadmaps and essential picks to get started.</p>
            </div>
            <a href="{{ "start/" | relURL }}" class="cta-button">Getting Started</a>
        </div>
    </div>

    <!-- Section Cards Grid -->
    <div class="section-grid">
        <a href="{{ "learning/" | relURL }}" class="section-card section-card-with-image" data-aos="fade-up">
            <div class="card-bg" style="background-image: url('/images/cards/learning-card.webp')"></div>
            <div class="card-content">
                <div class="section-icon">
                    <svg viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                    </svg>
                </div>
                <h3>Learning</h3>
                <p>{{ len .Site.Data.resources }} books, courses, and blogs to level up your skills</p>
            </div>
        </a>

        <a href="{{ "career/" | relURL }}" class="section-card section-card-with-image" data-aos="fade-up" data-aos-delay="50">
            <div class="card-bg" style="background-image: url('/images/cards/career-card.webp')"></div>
            <div class="card-content">
                <div class="section-icon">
                    <svg viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
                        <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
                    </svg>
                </div>
                <h3>Early Career</h3>
                <p>{{ len .Site.Data.career }} resources for job hunting and interviews</p>
            </div>
        </a>

        <a href="{{ "talks/" | relURL }}" class="section-card section-card-with-image" data-aos="fade-up" data-aos-delay="100">
            <div class="card-bg" style="background-image: url('/images/cards/talks-card.webp')"></div>
            <div class="card-content">
                <div class="section-icon">
                    <svg viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                        <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                        <line x1="12" y1="19" x2="12" y2="23"></line>
                        <line x1="8" y1="23" x2="16" y2="23"></line>
                    </svg>
                </div>
                <h3>Talks</h3>
                <p>{{ len .Site.Data.talks }} interviews and podcasts from chief economists</p>
            </div>
        </a>

        {{ $conferences := where .Site.Data.community "category" "Conferences" }}
        {{ $blogs := where .Site.Data.community "category" "Blogs" }}
        <a href="{{ "community/" | relURL }}" class="section-card section-card-with-image" data-aos="fade-up" data-aos-delay="150">
            <div class="card-bg" style="background-image: url('/images/cards/community-card.webp')"></div>
            <div class="card-content">
                <div class="section-icon">
                    <svg viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                </div>
                <h3>Community & Events</h3>
                <p>{{ len $conferences }} conferences • {{ len $blogs }} practitioner blogs</p>
            </div>
        </a>

        <a href="{{ "discover/" | relURL }}" class="section-card section-card-with-image" data-aos="fade-up" data-aos-delay="175">
            <div class="card-bg" style="background-image: url('/images/hero/discover-hero.webp')"></div>
            <div class="card-content">
                <div class="section-icon">
                    <svg viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"></polygon>
                    </svg>
                </div>
                <h3>Discover</h3>
                <p>{{ .Site.Data.topic_clusters_all.num_clusters }} topic clusters across {{ .Site.Data.topic_clusters_all.num_items }} resources</p>
            </div>
        </a>

        <a href="{{ "papers/" | relURL }}" class="section-card section-card-with-image" data-aos="fade-up" data-aos-delay="200">
            <div class="card-bg" style="background-image: url('/images/cards/papers-card.webp')"></div>
            <div class="card-content">
                <div class="section-icon">
                    <svg viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                </div>
                <h3>Papers</h3>
                <p>{{ len .Site.Data.papers.topics }} curated reading lists for tech economists</p>
            </div>
        </a>

        <a href="{{ "packages/" | relURL }}" class="section-card section-card-with-image" data-aos="fade-up" data-aos-delay="250">
            <div class="card-bg" style="background-image: url('/images/cards/packages-card.webp')"></div>
            <div class="card-content">
                <div class="section-icon">
                    <svg viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                        <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                        <line x1="12" y1="22.08" x2="12" y2="12"></line>
                    </svg>
                </div>
                <h3>Packages</h3>
                <p>{{ len .Site.Data.packages }} Python libraries for ML, causal inference, time series, and more</p>
            </div>
        </a>

        <a href="{{ "datasets/" | relURL }}" class="section-card section-card-with-image" data-aos="fade-up" data-aos-delay="300">
            <div class="card-bg" style="background-image: url('/images/cards/datasets-card.webp')"></div>
            <div class="card-content">
                <div class="section-icon">
                    <svg viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="currentColor" stroke-width="2">
                        <ellipse cx="12" cy="5" rx="9" ry="3"></ellipse>
                        <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path>
                        <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path>
                    </svg>
                </div>
                <h3>Datasets</h3>
                <p>{{ len .Site.Data.datasets }} industry datasets across e-commerce, economics, and ML</p>
            </div>
        </a>
    </div>

    <!-- Events Near You CTA -->
    <div class="cta-banner events-cta" data-aos="fade-up">
        <div class="cta-content">
            <a href="{{ "community/" | relURL }}#map" class="cta-icon">
                <svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                    <circle cx="12" cy="10" r="3"></circle>
                </svg>
            </a>
            <div class="cta-text">
                <h2>Events Near You</h2>
                <p>Find conferences, meetups, and communities in your area.</p>
            </div>
            <a href="{{ "community/" | relURL }}#map" class="cta-button">View Map</a>
        </div>
    </div>

    <!-- Subscribe CTA -->
    <div class="cta-banner subscribe-cta" data-aos="fade-up">
        <div class="cta-content">
            <div class="cta-icon">
                <svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                    <polyline points="22,6 12,13 2,6"></polyline>
                </svg>
            </div>
            <div class="cta-text">
                <h2>Stay Updated</h2>
                <p>Get notified on major updates. No spam, just quarterly highlights.</p>
            </div>
            <form action="https://formspree.io/f/xnjqdebp" method="POST" class="homepage-subscribe-form">
                <input type="email" name="email" placeholder="your@email.com" required class="subscribe-input">
                <button type="submit" class="cta-button">Subscribe</button>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="homepage-footer">
        <p>Built for tech economists. <a href="https://github.com/rawatpranjal/tech-econ" target="_blank">Contribute on GitHub</a></p>
        <p class="link-health" id="link-health"></p>
    </footer>
</div>

<script>
// Fetch and display link health score
(function() {
    var el = document.getElementById('link-health');
    if (!el) return;

    fetch('/link-health.json')
        .then(function(r) { return r.json(); })
        .then(function(data) {
            if (data.score !== undefined) {
                el.textContent = 'Link Quality: ' + data.score + '% (among ' + data.checked + ' verifiable links)';
            }
        })
        .catch(function() {});
})();
</script>
{{ end }}
